const http = require('http');
const https = require('https');
const url = require('url');

const server = http.createServer((req, res) => {
  // Set CORS headers for all requests
  res.setHeader('Access-Control-Allow-Origin', 'http://localhost:3000');
  res.setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS');
  res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Cookie');

  // Handle preflight OPTIONS requests
  if (req.method === 'OPTIONS') {
    res.writeHead(200);
    res.end();
    return;
  }

  // Handle GET request to the first API Agoda for RoomList
  if (req.method === 'GET' && req.url === '/get-api') {
    const proxyUrl = 'https://ycs.agoda.com/en-us/39578023/kipp/api/roomtype/GetRoomList?recStatus=1,0';
    const options = url.parse(proxyUrl);

    // Set the necessary headers, including the "Cookie" header
    options.headers = {
            Cookie: 'agoda.user.03=UserId=ece53528-67e8-45e5-bca0-bd42a5bb83c1; agoda.prius=PriusID=0&PointsMaxTraffic=Agoda; ai_user=Hf91Vhey2x3HjMNJBzu7/5|2023-05-04T04:52:39.776Z; UserName=barakcontinentz@gmail.com; LoginRememberMe=True; LoginKeepMeSignedIn=True; countrySelection=; agoda.firstclicks=1891466||3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||2023-05-04T14:25:23||3ihvmypcv1i0j1ukjyrpadra||{"IsPaid":true,"gclid":"","Type":""}; agoda.version.03=CookieId=c08fd177-c86d-4935-a336-4ee5c86aafe7&TItems=2$1891466$05-04-2023 14:25$06-03-2023 14:25$3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51&DLang=en-us&CurLabel=PKR; agoda.attr.03=ATItems=1891466$05-04-2023 14:25$3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51; agoda.familyMode=Mode=0; agoda.search.01=SHist=4$820474$8167$1$1$1$0$0$$$0&H=8158|0$820474; agoda.price.01=PriceView=1; deviceId=31330941-ef30-4e0e-adfb-7fa0de9a7402; agoda.consent=PK||2023-05-04 14:25:26Z; _ga_T408Z268D2=GS1.1.1683185128.1.1.1683185137.51.0.0; utag_main=v_id:0187e5a6f8f100035b4f6568012c0506f02c706700978$_sn:1$_se:2$_ss:0$_st:1683186941684$ses_id:1683185137907%3Bexp-session$_pn:1%3Bexp-session; _uetvid=e04fea40ea4c11ed82e69bddb32a6624; ftr_ncd=6; _fbp=fb.1.1683185142391.1459138873; rskxRunCookie=0; rCookie=sbmte0zzhzzvnj649ba1lh8sz3yf; lastRskxRun=1683185142475; forterToken=941fe45529a648bdafea84a5bb517238_1683185141680__UDF43-m4_9ck; agoda.lastclicks=1891466||3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||2023-05-04T14:25:54||3ihvmypcv1i0j1ukjyrpadra||{"IsPaid":true,"gclid":"Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB","Type":""}; agoda.landings=1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:23|True|19----1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51|Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB|3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:54|True|20----1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51|Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB|3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:54|True|99; FPID=FPID2.2.dhyHJwC%2BMOg%2FCy55gzw8TKor1dn0y5xtiJy1MPjPbiQ%3D.1683185128; __hs_opt_out=no; __hs_initial_opt_in=true; __hstc=261547474.11bff3a132d25dc7f4a55b66dd830766.1683782859893.1683782859893.1683782859893.1; hubspotutk=11bff3a132d25dc7f4a55b66dd830766; __hssrc=1; _ga=GA1.1.2060799732.1683185128; CSRF_TOKEN=r4v2rg4M6O0I-lxy5RIMjMz8XSiow4ar_shqS3eFrYk_HjA5uoHzDc3ph3poMhFfLBUH2iYxDxlSUbmzAQL5lOgf8i01; NonPersistSessionTime=06:00:00; _ga_80F3X70H1C=GS1.1.1683782863.1.1.1683783387.0.0.0; ASP.NET_SessionId=mr05h00lo0gez3hy4yq01qet; ycs_session_cache={"Cache":"hkdata1","Time":"638193805990012890","SessionID":"mr05h00lo0gez3hy4yq01qet","CheckID":"0c31f8549a2e43ce22360a443b7e57d7e1d4de9f","CType":"N"}; mfau={"986D269142015057E1C481986BE8B404":["91497F181E5D8D334DDFB8076937B266","D077A9635352AB83B1F75F560E23F5B3","2F26A8E6D579322D442A1EDBF2941392","A204FE7430904174833E4E4141B18994"]}; tokenp=eyJhbGciOiJFUzI1NiJ9.eyJtIjozMTU1NDY2NDIsInIiOlsiMTMwXzM5NTc4MDIyIiwiNTVfMzk1NzgwMjMiLCIyMjBfMzk1NzgwMjMiLCIyMzBfMzk1NzgwMjIiLCIyMzBfMzk1NzgwMjMiXSwiZSI6IjRSb1FmaDohbS5zXCJ1JGhmTE1wJTBSXjBqSSxKPFkxQi9QRGcySC5IVGNZPXUmMz5ubD5cXGBgVjgrcFowXTEwRGAhTDFTbVonRVBwciZOdVYiLCJzcmMiOiJzcmMiLCJzdWIiOiJVeW9fRWxUUVRxeXJ0SUoxbnRKOUVBIiwianRpIjoiUjZmWC0yMzFSV0dENGZYZnZzSEhmdyIsImlhdCI6MTY4Mzc4Mzg0MSwiZXhwIjoxNjkxNTU5ODQxLCJtciI6dHJ1ZSwid2x0IjoiZjFhNTkwNWYtOTYyMC00NWU1LTlkOTEtZDI1MWMwN2UwYjQyIiwibWFhdCI6MTY4Mzc4Mzg0MX0.LSR5A8GS3q2Ew4LoS1J8kvKy0vH4RDfR8sHSX92qg8WsylYn7CzfrSzvS_7tAbLMiDIipbFSk9wUyB2ucvIvRg; APSXYCS40=645F9815A76545DC11C5093DC31E10B0B7E76F3C032633FD4D97C4479681651A3B5054363DC1C8CBB691721DABC8929AD1FDA3D83BE0B372C05867A5D2DA02334EF6C7D90729EE675C17645F04AE8D22B389F982C2D618D08B1CCA4305D76E9F742F1AFCA0A0A3255229F84B992B1A38B6EF2E603597E2B21933952092311D94F3ED5E15DF440234D0D8526E07E6AAB4C2599CC7DEB6D71FA237DBC39289E96F8D0D427D68CC4FCFF41B93A1B46CD02AA9F87FB3B1D5DA05DC11160B02D20A6BD32C84AB2C6AD16CB18C4DB247858D4EE2070D6DCF5CD47EC2ED4F684F77CD264F70494F3952C23519FA094E2DADD9F4DC39D2BE3AA6A34D1C66AA203F9ECAB7A1D553E01B24958F42C3F30528EC056D46601854F9B0A7AAE1C20529FA66DBD1957A9D7E59A83D9BBA40F1E065DEAA89C2D5A4DEFE5E9B549C0B3EA92F79D5B861ADB5D4F96AE21F80076EBF9584416BD6A2D3282628F1F5BEB818B7066E4A1348BFEF112355B4163D6E6602717B95807BBDE4EB0252D14A60D0F96CBA2AAF5A6FE5C222F9519BFB2D9FC364BF8CD66CA68217D0077A4C548F40DF67EE9172DAC70D8CE0939C3A539026670D8C9358D46615C56DDFE70C5A5FE1BA25A83EEC0709C73DEDF825D6254A9802E04C9EA96902C7621E7F47EE41DA05BB7DC3D2A13C055EF7EE195F25831E813E1D05652D2D4FBC8DEECE349FC77CB0E33A6EB6D73AB3B06E3B150D2332ECC8E81112FC9DB1FD73D5292DD08E30464DE3D6B3B6FD7B80C594571C9A1E8C2FFED167412D0AE00E7875527241A558D21637D1BF706DF6A03D03F45B5A091436892CA9E9A543B06778A267AB86636F5697A10D1C8C18433E37FE55759B9158DCDAA3426E7BE0AC658753C8A2AA01666A6CB84BBD5E7F3350951FEE86F7790301E0B669720DAED3B2E3B3B0E9E65ACFBA6E271C6D511B37CF334F078DA31ED76DD2CD9B9A9D6AE5E62FB650B2AFC64D248EBE7CAA7D100438305030B10CCC9A2EE4B61042358FE1F51BD2FC31BE6DCDC6E661B480E6E7F90EF3662F2FC01370B5479AEDBC480A86671B49E37A32372C55C80A5DAB148872298DF02AB205F79A4D4BF962911FF9706F4BAEFD2D468F5E68C76024C91AA39ABD75AEDABE7F714FEDA6BC87117C3D40BEE37EEB1AB15D91F48B12AC916811102A752B5D52D7F074CDEDCA0C6206261E79489183C92C59A911F4793FE11D85047A409659251E24BB0E4B80A323B6F15D7582DE59C6F902290B6AA17EC1DABD0C4C105E67F4C73C2C4333433F96466BB78C866DB24DCB83D3ED428C007DE4D5770ABD450B170D6606E07BC6162D331499DBDB7D9BC4A0F2C312B303BC50435B25437F55F8AFC441443C550B6C9B50681CDF1D9FD4F77020741C7092402F4C530719F2963B6C89823A521332722137D47E9A1DDAEFABCE72CC257BA83BF8A37F14AC3F045185F45DBE60D889DFC6223B58382A36654F1F734C548E990FACF2E5D88EA963B9AF370B78258005FE81374B3D31C690CA8C875AC9F2013A954ED7E6EE5095EA7FFA372E46AEAA6BC988E4EF91AB156E26A598862568BCA1A9F5147E844365DA794F0E2F90E649EF9749E39889906CCA995C8EEE3D9257BBA4E9BD9756F845081F36324B32680F7B49056A06475458A58EA93983F04FE996CC2A67248AD0DC9BFB519C70B2CE1D3FB589CE67CD50CDD1CD18544862357A594ACA8ED94FB130D3325BAB7E8D19FFF3D1E363C203D831B29B890195E279F0669D4DE1D0C72408025A34550A89F68CFB1F15A99C1A4C84D3911D17DF4A10C37BA474BEB52777961E4C8605DE54008681DB07EE0CF0459D41946A16DD5B1EF7A0B95B426652C0A53D759F31497697B6C4DB561FB4782D2F87097A1974CEC20269050B092B6D2592286741827620E214EE8FB5CABA796388176FB8B4590E9C23EBBF3B1765014A703CABA70D93094E731D0635A53919F45A5433CF7024B8773D3B69E5BB603B4658895DC386E8DB536622771907044297E934A08EF8EFB03906A7EF9AEAFA92F156A7E96B58F125A47CE599C3C4C1859479F42BE73B11738753187D117DA3955EB8369CF4E2862F7E6B62893038E33AD284DD5C73521975F7A368374349DF6F5A6FA300D300D88DA1C036EA02F9A79505CC197DEFE7316575BF81E9480FFA8EA13E8C1A7A77BD1446CB965D65B54D1CB9DB64BAAE18EAE7E1B753B1689C26870C465888BF982B51ADF2267EDD46FB83D85E1461E40C952656B231FA51F410D6D3C3D5621932926C736EAA2D1132001E692B9447232B3E83069D88B098AB33E568DA300BE32722B0E98880E8353148025409BD5A560DE94B4A33CACD1FED7D869AF64CD8E55693D441ECEF20D747DFFBFF22646CA8959992FBADDB7F14B5D12686F0FBBD4D23889996DB34EAF0F580B87397FCE058C8C13206296025CC63887B01AC7DC9F0DE3C63D8C212035C991E594137F7D778E8B4567800A65A63514910840B404BAC33CEF06951CA83E54B8ECC497F813ADF3A96AB8F725D4319252A6C2BD2C93C8B27571D26BD8082624D080D7103C30C245695D7F9A642B3BB1F339DE69936BB7E73F05C040171999FBD6DFC54D446C23941432D0DD628745D467C7EF12DC063C6FA754F9C3537138F58BA6337A845962489B51D35FAB01C51619F252338A63E; loggedInProfileHistory=[{"email":"barakcontinentz@gmail.com","avatarId":"AGJ001","logInTime":"2023-05-11T05:44:03.926Z","loginFlowState":3}]; ab.storage.sessionId.a73da5f8-ee6e-401e-974a-488ed7de6d1c=%7B%22g%22%3A%226c9b27cd-c759-f018-e566-529d01d50247%22%2C%22e%22%3A1683785659715%2C%22c%22%3A1683782913588%2C%22l%22%3A1683783859715%7D; ai_session=RKhy+BD9IDp59BKkz7dK1K|1683782898057|1683785169636; agoda.analytics=Id=-5681229916979378893&Signature=-5936136120101259533&Expiry=1683789143416',

    };

    https.get(options, (proxyRes) => {
      proxyRes.pipe(res);
    });

    return;
  }
   // Handle Post request to the first API Agoda for Hotel Status
   if (req.method === 'POST' && req.url === '/hotel-api') {
    const proxyUrl = 'https://ycs.agoda.com/en-us/kipp/api/hotelselectionapi/SearchHotel?';
    const options = url.parse(proxyUrl);

    // Set the necessary headers, including the "Cookie" header
    options.headers = {
      Cookie: 'agoda.user.03=UserId=ece53528-67e8-45e5-bca0-bd42a5bb83c1; agoda.prius=PriusID=0&PointsMaxTraffic=Agoda; ai_user=Hf91Vhey2x3HjMNJBzu7/5|2023-05-04T04:52:39.776Z; UserName=barakcontinentz@gmail.com; LoginRememberMe=True; LoginKeepMeSignedIn=True; countrySelection=; agoda.firstclicks=1891466||3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||2023-05-04T14:25:23||3ihvmypcv1i0j1ukjyrpadra||{"IsPaid":true,"gclid":"","Type":""}; agoda.version.03=CookieId=c08fd177-c86d-4935-a336-4ee5c86aafe7&TItems=2$1891466$05-04-2023 14:25$06-03-2023 14:25$3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51&DLang=en-us&CurLabel=PKR; agoda.attr.03=ATItems=1891466$05-04-2023 14:25$3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51; agoda.familyMode=Mode=0; agoda.search.01=SHist=4$820474$8167$1$1$1$0$0$$$0&H=8158|0$820474; agoda.price.01=PriceView=1; deviceId=31330941-ef30-4e0e-adfb-7fa0de9a7402; agoda.consent=PK||2023-05-04 14:25:26Z; _ga_T408Z268D2=GS1.1.1683185128.1.1.1683185137.51.0.0; utag_main=v_id:0187e5a6f8f100035b4f6568012c0506f02c706700978$_sn:1$_se:2$_ss:0$_st:1683186941684$ses_id:1683185137907%3Bexp-session$_pn:1%3Bexp-session; _uetvid=e04fea40ea4c11ed82e69bddb32a6624; ftr_ncd=6; _fbp=fb.1.1683185142391.1459138873; rskxRunCookie=0; rCookie=sbmte0zzhzzvnj649ba1lh8sz3yf; lastRskxRun=1683185142475; forterToken=941fe45529a648bdafea84a5bb517238_1683185141680__UDF43-m4_9ck; agoda.lastclicks=1891466||3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||2023-05-04T14:25:54||3ihvmypcv1i0j1ukjyrpadra||{"IsPaid":true,"gclid":"Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB","Type":""}; agoda.landings=1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:23|True|19----1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51|Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB|3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:54|True|20----1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51|Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB|3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:54|True|99; FPID=FPID2.2.dhyHJwC%2BMOg%2FCy55gzw8TKor1dn0y5xtiJy1MPjPbiQ%3D.1683185128; __hs_opt_out=no; __hs_initial_opt_in=true; __hstc=261547474.11bff3a132d25dc7f4a55b66dd830766.1683782859893.1683782859893.1683782859893.1; hubspotutk=11bff3a132d25dc7f4a55b66dd830766; __hssrc=1; _ga=GA1.1.2060799732.1683185128; CSRF_TOKEN=r4v2rg4M6O0I-lxy5RIMjMz8XSiow4ar_shqS3eFrYk_HjA5uoHzDc3ph3poMhFfLBUH2iYxDxlSUbmzAQL5lOgf8i01; NonPersistSessionTime=06:00:00; _ga_80F3X70H1C=GS1.1.1683782863.1.1.1683783387.0.0.0; ASP.NET_SessionId=mr05h00lo0gez3hy4yq01qet; ycs_session_cache={"Cache":"hkdata1","Time":"638193805990012890","SessionID":"mr05h00lo0gez3hy4yq01qet","CheckID":"0c31f8549a2e43ce22360a443b7e57d7e1d4de9f","CType":"N"}; mfau={"986D269142015057E1C481986BE8B404":["91497F181E5D8D334DDFB8076937B266","D077A9635352AB83B1F75F560E23F5B3","2F26A8E6D579322D442A1EDBF2941392","A204FE7430904174833E4E4141B18994"]}; tokenp=eyJhbGciOiJFUzI1NiJ9.eyJtIjozMTU1NDY2NDIsInIiOlsiMTMwXzM5NTc4MDIyIiwiNTVfMzk1NzgwMjMiLCIyMjBfMzk1NzgwMjMiLCIyMzBfMzk1NzgwMjIiLCIyMzBfMzk1NzgwMjMiXSwiZSI6IjRSb1FmaDohbS5zXCJ1JGhmTE1wJTBSXjBqSSxKPFkxQi9QRGcySC5IVGNZPXUmMz5ubD5cXGBgVjgrcFowXTEwRGAhTDFTbVonRVBwciZOdVYiLCJzcmMiOiJzcmMiLCJzdWIiOiJVeW9fRWxUUVRxeXJ0SUoxbnRKOUVBIiwianRpIjoiUjZmWC0yMzFSV0dENGZYZnZzSEhmdyIsImlhdCI6MTY4Mzc4Mzg0MSwiZXhwIjoxNjkxNTU5ODQxLCJtciI6dHJ1ZSwid2x0IjoiZjFhNTkwNWYtOTYyMC00NWU1LTlkOTEtZDI1MWMwN2UwYjQyIiwibWFhdCI6MTY4Mzc4Mzg0MX0.LSR5A8GS3q2Ew4LoS1J8kvKy0vH4RDfR8sHSX92qg8WsylYn7CzfrSzvS_7tAbLMiDIipbFSk9wUyB2ucvIvRg; APSXYCS40=645F9815A76545DC11C5093DC31E10B0B7E76F3C032633FD4D97C4479681651A3B5054363DC1C8CBB691721DABC8929AD1FDA3D83BE0B372C05867A5D2DA02334EF6C7D90729EE675C17645F04AE8D22B389F982C2D618D08B1CCA4305D76E9F742F1AFCA0A0A3255229F84B992B1A38B6EF2E603597E2B21933952092311D94F3ED5E15DF440234D0D8526E07E6AAB4C2599CC7DEB6D71FA237DBC39289E96F8D0D427D68CC4FCFF41B93A1B46CD02AA9F87FB3B1D5DA05DC11160B02D20A6BD32C84AB2C6AD16CB18C4DB247858D4EE2070D6DCF5CD47EC2ED4F684F77CD264F70494F3952C23519FA094E2DADD9F4DC39D2BE3AA6A34D1C66AA203F9ECAB7A1D553E01B24958F42C3F30528EC056D46601854F9B0A7AAE1C20529FA66DBD1957A9D7E59A83D9BBA40F1E065DEAA89C2D5A4DEFE5E9B549C0B3EA92F79D5B861ADB5D4F96AE21F80076EBF9584416BD6A2D3282628F1F5BEB818B7066E4A1348BFEF112355B4163D6E6602717B95807BBDE4EB0252D14A60D0F96CBA2AAF5A6FE5C222F9519BFB2D9FC364BF8CD66CA68217D0077A4C548F40DF67EE9172DAC70D8CE0939C3A539026670D8C9358D46615C56DDFE70C5A5FE1BA25A83EEC0709C73DEDF825D6254A9802E04C9EA96902C7621E7F47EE41DA05BB7DC3D2A13C055EF7EE195F25831E813E1D05652D2D4FBC8DEECE349FC77CB0E33A6EB6D73AB3B06E3B150D2332ECC8E81112FC9DB1FD73D5292DD08E30464DE3D6B3B6FD7B80C594571C9A1E8C2FFED167412D0AE00E7875527241A558D21637D1BF706DF6A03D03F45B5A091436892CA9E9A543B06778A267AB86636F5697A10D1C8C18433E37FE55759B9158DCDAA3426E7BE0AC658753C8A2AA01666A6CB84BBD5E7F3350951FEE86F7790301E0B669720DAED3B2E3B3B0E9E65ACFBA6E271C6D511B37CF334F078DA31ED76DD2CD9B9A9D6AE5E62FB650B2AFC64D248EBE7CAA7D100438305030B10CCC9A2EE4B61042358FE1F51BD2FC31BE6DCDC6E661B480E6E7F90EF3662F2FC01370B5479AEDBC480A86671B49E37A32372C55C80A5DAB148872298DF02AB205F79A4D4BF962911FF9706F4BAEFD2D468F5E68C76024C91AA39ABD75AEDABE7F714FEDA6BC87117C3D40BEE37EEB1AB15D91F48B12AC916811102A752B5D52D7F074CDEDCA0C6206261E79489183C92C59A911F4793FE11D85047A409659251E24BB0E4B80A323B6F15D7582DE59C6F902290B6AA17EC1DABD0C4C105E67F4C73C2C4333433F96466BB78C866DB24DCB83D3ED428C007DE4D5770ABD450B170D6606E07BC6162D331499DBDB7D9BC4A0F2C312B303BC50435B25437F55F8AFC441443C550B6C9B50681CDF1D9FD4F77020741C7092402F4C530719F2963B6C89823A521332722137D47E9A1DDAEFABCE72CC257BA83BF8A37F14AC3F045185F45DBE60D889DFC6223B58382A36654F1F734C548E990FACF2E5D88EA963B9AF370B78258005FE81374B3D31C690CA8C875AC9F2013A954ED7E6EE5095EA7FFA372E46AEAA6BC988E4EF91AB156E26A598862568BCA1A9F5147E844365DA794F0E2F90E649EF9749E39889906CCA995C8EEE3D9257BBA4E9BD9756F845081F36324B32680F7B49056A06475458A58EA93983F04FE996CC2A67248AD0DC9BFB519C70B2CE1D3FB589CE67CD50CDD1CD18544862357A594ACA8ED94FB130D3325BAB7E8D19FFF3D1E363C203D831B29B890195E279F0669D4DE1D0C72408025A34550A89F68CFB1F15A99C1A4C84D3911D17DF4A10C37BA474BEB52777961E4C8605DE54008681DB07EE0CF0459D41946A16DD5B1EF7A0B95B426652C0A53D759F31497697B6C4DB561FB4782D2F87097A1974CEC20269050B092B6D2592286741827620E214EE8FB5CABA796388176FB8B4590E9C23EBBF3B1765014A703CABA70D93094E731D0635A53919F45A5433CF7024B8773D3B69E5BB603B4658895DC386E8DB536622771907044297E934A08EF8EFB03906A7EF9AEAFA92F156A7E96B58F125A47CE599C3C4C1859479F42BE73B11738753187D117DA3955EB8369CF4E2862F7E6B62893038E33AD284DD5C73521975F7A368374349DF6F5A6FA300D300D88DA1C036EA02F9A79505CC197DEFE7316575BF81E9480FFA8EA13E8C1A7A77BD1446CB965D65B54D1CB9DB64BAAE18EAE7E1B753B1689C26870C465888BF982B51ADF2267EDD46FB83D85E1461E40C952656B231FA51F410D6D3C3D5621932926C736EAA2D1132001E692B9447232B3E83069D88B098AB33E568DA300BE32722B0E98880E8353148025409BD5A560DE94B4A33CACD1FED7D869AF64CD8E55693D441ECEF20D747DFFBFF22646CA8959992FBADDB7F14B5D12686F0FBBD4D23889996DB34EAF0F580B87397FCE058C8C13206296025CC63887B01AC7DC9F0DE3C63D8C212035C991E594137F7D778E8B4567800A65A63514910840B404BAC33CEF06951CA83E54B8ECC497F813ADF3A96AB8F725D4319252A6C2BD2C93C8B27571D26BD8082624D080D7103C30C245695D7F9A642B3BB1F339DE69936BB7E73F05C040171999FBD6DFC54D446C23941432D0DD628745D467C7EF12DC063C6FA754F9C3537138F58BA6337A845962489B51D35FAB01C51619F252338A63E; loggedInProfileHistory=[{"email":"barakcontinentz@gmail.com","avatarId":"AGJ001","logInTime":"2023-05-11T05:44:03.926Z","loginFlowState":3}]; ab.storage.sessionId.a73da5f8-ee6e-401e-974a-488ed7de6d1c=%7B%22g%22%3A%226c9b27cd-c759-f018-e566-529d01d50247%22%2C%22e%22%3A1683785659715%2C%22c%22%3A1683782913588%2C%22l%22%3A1683783859715%7D; ai_session=RKhy+BD9IDp59BKkz7dK1K|1683782898057|1683785169636; agoda.analytics=Id=-5681229916979378893&Signature=-5936136120101259533&Expiry=1683789143416',
      'Content-Type': 'application/json',
    };

    let requestBody = '';

    req.on('data', (chunk) => {
      requestBody += chunk;
    });

    req.on('end', () => {
      options.method = 'POST';
      options.headers['Content-Length'] = Buffer.byteLength(requestBody);

      const proxyReq = https.request(options, (proxyRes) => {
        proxyRes.pipe(res);
      });

      proxyReq.write(requestBody);
      proxyReq.end();
    });

    return;
  }

  // Handle POST request to the second API Agoda for Update Record
  if (req.method === 'POST' && req.url === '/post-api') {
    const proxyUrl = 'https://ycs.agoda.com/en-us/39578023/kipp/api/roomtype/UpdateRoomType';
    const options = url.parse(proxyUrl);

    // Set the necessary headers, including the "Cookie" header
    options.headers = {
      Cookie: 'agoda.user.03=UserId=ece53528-67e8-45e5-bca0-bd42a5bb83c1; agoda.prius=PriusID=0&PointsMaxTraffic=Agoda; ai_user=Hf91Vhey2x3HjMNJBzu7/5|2023-05-04T04:52:39.776Z; UserName=barakcontinentz@gmail.com; LoginRememberMe=True; LoginKeepMeSignedIn=True; countrySelection=; agoda.firstclicks=1891466||3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||2023-05-04T14:25:23||3ihvmypcv1i0j1ukjyrpadra||{"IsPaid":true,"gclid":"","Type":""}; agoda.version.03=CookieId=c08fd177-c86d-4935-a336-4ee5c86aafe7&TItems=2$1891466$05-04-2023 14:25$06-03-2023 14:25$3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51&DLang=en-us&CurLabel=PKR; agoda.attr.03=ATItems=1891466$05-04-2023 14:25$3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51; agoda.familyMode=Mode=0; agoda.search.01=SHist=4$820474$8167$1$1$1$0$0$$$0&H=8158|0$820474; agoda.price.01=PriceView=1; deviceId=31330941-ef30-4e0e-adfb-7fa0de9a7402; agoda.consent=PK||2023-05-04 14:25:26Z; _ga_T408Z268D2=GS1.1.1683185128.1.1.1683185137.51.0.0; utag_main=v_id:0187e5a6f8f100035b4f6568012c0506f02c706700978$_sn:1$_se:2$_ss:0$_st:1683186941684$ses_id:1683185137907%3Bexp-session$_pn:1%3Bexp-session; _uetvid=e04fea40ea4c11ed82e69bddb32a6624; ftr_ncd=6; _fbp=fb.1.1683185142391.1459138873; rskxRunCookie=0; rCookie=sbmte0zzhzzvnj649ba1lh8sz3yf; lastRskxRun=1683185142475; forterToken=941fe45529a648bdafea84a5bb517238_1683185141680__UDF43-m4_9ck; agoda.lastclicks=1891466||3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||2023-05-04T14:25:54||3ihvmypcv1i0j1ukjyrpadra||{"IsPaid":true,"gclid":"Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB","Type":""}; agoda.landings=1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51||3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:23|True|19----1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51|Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB|3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:54|True|20----1891466|3a37b02a-bc69-20e1-1a4f-fcc3a67d7b51|Cj0KCQjwr82iBhCuARIsAO0EAZwZda4PSh8W1dB1xD4Wyho33GYjq9iPqLes3MyFoCtD9nPe9wISeCAaAg9lEALw_wcB|3ihvmypcv1i0j1ukjyrpadra|2023-05-04T14:25:54|True|99; FPID=FPID2.2.dhyHJwC%2BMOg%2FCy55gzw8TKor1dn0y5xtiJy1MPjPbiQ%3D.1683185128; __hs_opt_out=no; __hs_initial_opt_in=true; __hstc=261547474.11bff3a132d25dc7f4a55b66dd830766.1683782859893.1683782859893.1683782859893.1; hubspotutk=11bff3a132d25dc7f4a55b66dd830766; __hssrc=1; _ga=GA1.1.2060799732.1683185128; CSRF_TOKEN=r4v2rg4M6O0I-lxy5RIMjMz8XSiow4ar_shqS3eFrYk_HjA5uoHzDc3ph3poMhFfLBUH2iYxDxlSUbmzAQL5lOgf8i01; NonPersistSessionTime=06:00:00; _ga_80F3X70H1C=GS1.1.1683782863.1.1.1683783387.0.0.0; ASP.NET_SessionId=mr05h00lo0gez3hy4yq01qet; ycs_session_cache={"Cache":"hkdata1","Time":"638193805990012890","SessionID":"mr05h00lo0gez3hy4yq01qet","CheckID":"0c31f8549a2e43ce22360a443b7e57d7e1d4de9f","CType":"N"}; mfau={"986D269142015057E1C481986BE8B404":["91497F181E5D8D334DDFB8076937B266","D077A9635352AB83B1F75F560E23F5B3","2F26A8E6D579322D442A1EDBF2941392","A204FE7430904174833E4E4141B18994"]}; tokenp=eyJhbGciOiJFUzI1NiJ9.eyJtIjozMTU1NDY2NDIsInIiOlsiMTMwXzM5NTc4MDIyIiwiNTVfMzk1NzgwMjMiLCIyMjBfMzk1NzgwMjMiLCIyMzBfMzk1NzgwMjIiLCIyMzBfMzk1NzgwMjMiXSwiZSI6IjRSb1FmaDohbS5zXCJ1JGhmTE1wJTBSXjBqSSxKPFkxQi9QRGcySC5IVGNZPXUmMz5ubD5cXGBgVjgrcFowXTEwRGAhTDFTbVonRVBwciZOdVYiLCJzcmMiOiJzcmMiLCJzdWIiOiJVeW9fRWxUUVRxeXJ0SUoxbnRKOUVBIiwianRpIjoiUjZmWC0yMzFSV0dENGZYZnZzSEhmdyIsImlhdCI6MTY4Mzc4Mzg0MSwiZXhwIjoxNjkxNTU5ODQxLCJtciI6dHJ1ZSwid2x0IjoiZjFhNTkwNWYtOTYyMC00NWU1LTlkOTEtZDI1MWMwN2UwYjQyIiwibWFhdCI6MTY4Mzc4Mzg0MX0.LSR5A8GS3q2Ew4LoS1J8kvKy0vH4RDfR8sHSX92qg8WsylYn7CzfrSzvS_7tAbLMiDIipbFSk9wUyB2ucvIvRg; APSXYCS40=645F9815A76545DC11C5093DC31E10B0B7E76F3C032633FD4D97C4479681651A3B5054363DC1C8CBB691721DABC8929AD1FDA3D83BE0B372C05867A5D2DA02334EF6C7D90729EE675C17645F04AE8D22B389F982C2D618D08B1CCA4305D76E9F742F1AFCA0A0A3255229F84B992B1A38B6EF2E603597E2B21933952092311D94F3ED5E15DF440234D0D8526E07E6AAB4C2599CC7DEB6D71FA237DBC39289E96F8D0D427D68CC4FCFF41B93A1B46CD02AA9F87FB3B1D5DA05DC11160B02D20A6BD32C84AB2C6AD16CB18C4DB247858D4EE2070D6DCF5CD47EC2ED4F684F77CD264F70494F3952C23519FA094E2DADD9F4DC39D2BE3AA6A34D1C66AA203F9ECAB7A1D553E01B24958F42C3F30528EC056D46601854F9B0A7AAE1C20529FA66DBD1957A9D7E59A83D9BBA40F1E065DEAA89C2D5A4DEFE5E9B549C0B3EA92F79D5B861ADB5D4F96AE21F80076EBF9584416BD6A2D3282628F1F5BEB818B7066E4A1348BFEF112355B4163D6E6602717B95807BBDE4EB0252D14A60D0F96CBA2AAF5A6FE5C222F9519BFB2D9FC364BF8CD66CA68217D0077A4C548F40DF67EE9172DAC70D8CE0939C3A539026670D8C9358D46615C56DDFE70C5A5FE1BA25A83EEC0709C73DEDF825D6254A9802E04C9EA96902C7621E7F47EE41DA05BB7DC3D2A13C055EF7EE195F25831E813E1D05652D2D4FBC8DEECE349FC77CB0E33A6EB6D73AB3B06E3B150D2332ECC8E81112FC9DB1FD73D5292DD08E30464DE3D6B3B6FD7B80C594571C9A1E8C2FFED167412D0AE00E7875527241A558D21637D1BF706DF6A03D03F45B5A091436892CA9E9A543B06778A267AB86636F5697A10D1C8C18433E37FE55759B9158DCDAA3426E7BE0AC658753C8A2AA01666A6CB84BBD5E7F3350951FEE86F7790301E0B669720DAED3B2E3B3B0E9E65ACFBA6E271C6D511B37CF334F078DA31ED76DD2CD9B9A9D6AE5E62FB650B2AFC64D248EBE7CAA7D100438305030B10CCC9A2EE4B61042358FE1F51BD2FC31BE6DCDC6E661B480E6E7F90EF3662F2FC01370B5479AEDBC480A86671B49E37A32372C55C80A5DAB148872298DF02AB205F79A4D4BF962911FF9706F4BAEFD2D468F5E68C76024C91AA39ABD75AEDABE7F714FEDA6BC87117C3D40BEE37EEB1AB15D91F48B12AC916811102A752B5D52D7F074CDEDCA0C6206261E79489183C92C59A911F4793FE11D85047A409659251E24BB0E4B80A323B6F15D7582DE59C6F902290B6AA17EC1DABD0C4C105E67F4C73C2C4333433F96466BB78C866DB24DCB83D3ED428C007DE4D5770ABD450B170D6606E07BC6162D331499DBDB7D9BC4A0F2C312B303BC50435B25437F55F8AFC441443C550B6C9B50681CDF1D9FD4F77020741C7092402F4C530719F2963B6C89823A521332722137D47E9A1DDAEFABCE72CC257BA83BF8A37F14AC3F045185F45DBE60D889DFC6223B58382A36654F1F734C548E990FACF2E5D88EA963B9AF370B78258005FE81374B3D31C690CA8C875AC9F2013A954ED7E6EE5095EA7FFA372E46AEAA6BC988E4EF91AB156E26A598862568BCA1A9F5147E844365DA794F0E2F90E649EF9749E39889906CCA995C8EEE3D9257BBA4E9BD9756F845081F36324B32680F7B49056A06475458A58EA93983F04FE996CC2A67248AD0DC9BFB519C70B2CE1D3FB589CE67CD50CDD1CD18544862357A594ACA8ED94FB130D3325BAB7E8D19FFF3D1E363C203D831B29B890195E279F0669D4DE1D0C72408025A34550A89F68CFB1F15A99C1A4C84D3911D17DF4A10C37BA474BEB52777961E4C8605DE54008681DB07EE0CF0459D41946A16DD5B1EF7A0B95B426652C0A53D759F31497697B6C4DB561FB4782D2F87097A1974CEC20269050B092B6D2592286741827620E214EE8FB5CABA796388176FB8B4590E9C23EBBF3B1765014A703CABA70D93094E731D0635A53919F45A5433CF7024B8773D3B69E5BB603B4658895DC386E8DB536622771907044297E934A08EF8EFB03906A7EF9AEAFA92F156A7E96B58F125A47CE599C3C4C1859479F42BE73B11738753187D117DA3955EB8369CF4E2862F7E6B62893038E33AD284DD5C73521975F7A368374349DF6F5A6FA300D300D88DA1C036EA02F9A79505CC197DEFE7316575BF81E9480FFA8EA13E8C1A7A77BD1446CB965D65B54D1CB9DB64BAAE18EAE7E1B753B1689C26870C465888BF982B51ADF2267EDD46FB83D85E1461E40C952656B231FA51F410D6D3C3D5621932926C736EAA2D1132001E692B9447232B3E83069D88B098AB33E568DA300BE32722B0E98880E8353148025409BD5A560DE94B4A33CACD1FED7D869AF64CD8E55693D441ECEF20D747DFFBFF22646CA8959992FBADDB7F14B5D12686F0FBBD4D23889996DB34EAF0F580B87397FCE058C8C13206296025CC63887B01AC7DC9F0DE3C63D8C212035C991E594137F7D778E8B4567800A65A63514910840B404BAC33CEF06951CA83E54B8ECC497F813ADF3A96AB8F725D4319252A6C2BD2C93C8B27571D26BD8082624D080D7103C30C245695D7F9A642B3BB1F339DE69936BB7E73F05C040171999FBD6DFC54D446C23941432D0DD628745D467C7EF12DC063C6FA754F9C3537138F58BA6337A845962489B51D35FAB01C51619F252338A63E; loggedInProfileHistory=[{"email":"barakcontinentz@gmail.com","avatarId":"AGJ001","logInTime":"2023-05-11T05:44:03.926Z","loginFlowState":3}]; ab.storage.sessionId.a73da5f8-ee6e-401e-974a-488ed7de6d1c=%7B%22g%22%3A%226c9b27cd-c759-f018-e566-529d01d50247%22%2C%22e%22%3A1683785659715%2C%22c%22%3A1683782913588%2C%22l%22%3A1683783859715%7D; ai_session=RKhy+BD9IDp59BKkz7dK1K|1683782898057|1683785169636; agoda.analytics=Id=-5681229916979378893&Signature=-5936136120101259533&Expiry=1683789143416',
      'Content-Type': 'application/json',
    };

    let requestBody = '';

    req.on('data', (chunk) => {
      requestBody += chunk;
    });

    req.on('end', () => {
      options.method = 'POST';
      options.headers['Content-Length'] = Buffer.byteLength(requestBody);

      const proxyReq = https.request(options, (proxyRes) => {
        proxyRes.pipe(res);
      });

      proxyReq.write(requestBody);
      proxyReq.end();
    });

    return;
  }

  // Handle other requests
  res.statusCode = 404;
  res.end('Not Found');
});

server.listen(8000, () => {
  console.log('Server listening on port 8000');
});
